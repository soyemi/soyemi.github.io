<!DOCTYPE html>
<html lang=en>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="在整理代码的时候发现了以前clone的一个高斯模糊的repo,于是打算整理一下写篇blog。高斯模糊在游戏开发中最常见的用法就是PostPorocess、Image Effect了，但是为了获得更好的模糊效果就需要更多的贴图采样次数，会有很多性能上的压力。一个高效的高斯模糊算法是很必要的。 本文导读  介绍一种复杂度为O(n)的高斯模糊算法。  该模糊算法的GPU迁移。  在Unity中的实现的两">
<meta property="og:type" content="article">
<meta property="og:title" content="快速高斯模糊的Shader实现">
<meta property="og:url" content="https://yemi.me/2018/04/30/super-fast-blur-gpu/index.html">
<meta property="og:site_name" content="Yemi&#39;s Blog">
<meta property="og:description" content="在整理代码的时候发现了以前clone的一个高斯模糊的repo,于是打算整理一下写篇blog。高斯模糊在游戏开发中最常见的用法就是PostPorocess、Image Effect了，但是为了获得更好的模糊效果就需要更多的贴图采样次数，会有很多性能上的压力。一个高效的高斯模糊算法是很必要的。 本文导读  介绍一种复杂度为O(n)的高斯模糊算法。  该模糊算法的GPU迁移。  在Unity中的实现的两">
<meta property="og:image" content="https://yemi.me/images/fast-gaussian-blur.png">
<meta property="og:image" content="https://yemi.me/images/fast-blur-artifact.png">
<meta property="article:published_time" content="2018-04-30T10:20:13.000Z">
<meta property="article:modified_time" content="2020-02-17T10:12:35.216Z">
<meta property="article:author" content="yemi">
<meta property="article:tag" content="shader">
<meta property="article:tag" content="blur">
<meta property="article:tag" content="unity">
<meta property="article:tag" content="algorithms">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yemi.me/images/fast-gaussian-blur.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.png">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
          
        
    
    <!-- title -->
    <title>快速高斯模糊的Shader实现</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->

    <link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet">
    
    
<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body class="max-width mx-auto px3">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="https://artwork.yemi.me/" target="_blank" rel="noopener">Artworks</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/05/22/unity-code-analysis/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/04/25/roslyn-code-generation/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://yemi.me/2018/04/30/super-fast-blur-gpu/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&text=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&is_video=false&description=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=快速高斯模糊的Shader实现&body=Check out this article: https://yemi.me/2018/04/30/super-fast-blur-gpu/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&name=快速高斯模糊的Shader实现&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#最快速的高斯模糊算法"><span class="toc-number">1.</span> <span class="toc-text">最快速的高斯模糊算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#高斯函数与模糊卷积"><span class="toc-number">1.1.</span> <span class="toc-text">高斯函数与模糊卷积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BoxBlur-均值模糊"><span class="toc-number">1.2.</span> <span class="toc-text">BoxBlur 均值模糊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Box-Blur优化"><span class="toc-number">1.3.</span> <span class="toc-text">Box Blur优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用累加器减少采样"><span class="toc-number">1.4.</span> <span class="toc-text">使用累加器减少采样</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用GPU计算模糊"><span class="toc-number">2.</span> <span class="toc-text">使用GPU计算模糊</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#高斯模糊实现思路"><span class="toc-number">2.1.</span> <span class="toc-text">高斯模糊实现思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#另一种实现方式"><span class="toc-number">2.2.</span> <span class="toc-text">另一种实现方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Unity中实现代码"><span class="toc-number">3.</span> <span class="toc-text">Unity中实现代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">4.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        快速高斯模糊的Shader实现
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Yemi's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-04-30T10:20:13.000Z" itemprop="datePublished">2018-04-30</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/algorithms/" rel="tag">algorithms</a>, <a class="tag-link" href="/tags/blur/" rel="tag">blur</a>, <a class="tag-link" href="/tags/shader/" rel="tag">shader</a>, <a class="tag-link" href="/tags/unity/" rel="tag">unity</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>在整理代码的时候发现了以前clone的一个高斯模糊的<a href="https://github.com/mdymel/superfastblur" target="_blank" rel="noopener">repo</a>,于是打算整理一下写篇blog。高斯模糊在游戏开发中最常见的用法就是PostPorocess、Image Effect了，但是为了获得更好的模糊效果就需要更多的贴图采样次数，会有很多性能上的压力。一个高效的高斯模糊算法是很必要的。</p>
<p>本文导读</p>
<ul>
<li><p>介绍一种复杂度为O(n)的高斯模糊算法。</p>
</li>
<li><p>该模糊算法的GPU迁移。</p>
</li>
<li><p>在Unity中的实现的两种模糊方式以及对比。</p>
</li>
</ul>
<h2 id="最快速的高斯模糊算法"><a href="#最快速的高斯模糊算法" class="headerlink" title="最快速的高斯模糊算法"></a>最快速的高斯模糊算法</h2><h3 id="高斯函数与模糊卷积"><a href="#高斯函数与模糊卷积" class="headerlink" title="高斯函数与模糊卷积"></a>高斯函数与模糊卷积</h3><p>在中学的概率知识中我们都了解过正态分布，正态分布的权重就是高斯函数。</p>
<p>$$<br>\large f(x)= \frac{1}{\sqrt{2\pi}\rho}e^{-\frac{(x-\mu)^2}{2\sigma^2}}<br>$$</p>
<p>对于一张二维图片我们使用高斯函数的权重值作为矩阵，计算window region的卷积就可以得到这个region中心值的高斯模糊值。高斯函数的权重积分为1所以最后的图片的颜色值不会整体变亮或变暗。</p>
<p>用公式来表示就是对于一个像素$[i,j]$,取$r$为半径，计算该像素的blur值为：</p>
<p>$$<br>\large b[i,j] = \sum^{i+r}<em>{y=i-r} \sum^{j+r}</em>{x=j-r} f[x,y] * w[x,y]<br>$$</p>
<p>然而直接计算高斯模糊，算法的复杂度为$ O(n*r^{2}) $。</p>
<h3 id="BoxBlur-均值模糊"><a href="#BoxBlur-均值模糊" class="headerlink" title="BoxBlur 均值模糊"></a>BoxBlur 均值模糊</h3><p>均值模糊是另外一种模糊算法，相当于模糊计算时权重全部相同，即$ w[i,j] = \frac{1}{r^{2}} $。对于均值模糊来说，权重相同省去了权重的乘法计算，可以提升性能，但是由于均值是以一块r*r的大小区域计算的，模糊的效果会出现方形的artifact。而高斯权重分布式按照像素距离中心的距离，大于模糊半径权重就为0，会有柔和的过渡。</p>
<p>Peter Kovesi 在<a href="http://www.peterkovesi.com/papers/FastGaussianSmoothing.pdf" target="_blank" rel="noopener">Paper</a>中提出了,Box blur在多次iteration之后会逼近Gaussian分布。于是我们可以重复多次Box blur来替代高斯分布的权重计算。</p>
<p>同时Peter Kovesi还提出，高斯模糊的标准差和BoxBlur的box半径大小存在如下的关系。</p>
<p>$$<br>w = \sqrt{\frac{12\sigma^2}{n}+1}<br>$$<br>其中w为box的半径 $\sigma$为标准差(Standard Deviation)</p>
<h3 id="Box-Blur优化"><a href="#Box-Blur优化" class="headerlink" title="Box Blur优化"></a>Box Blur优化</h3><p>BoxBlur的公式：</p>
<p>$$<br>\large bb[i,j] = \sum^{i+br}<em>{y=i-br} \sum^{j+br}</em>{x=j-br} f[x,y] /(2 \cdot br)^2<br>$$</p>
<p>对于一个pixel 我们仍要采样br*br个像素的颜色值。由于是均值模糊，我们可以先对每个像素做横向的模糊再进行纵向的模糊，最终得到的结果不变。</p>
<p>$$<br>\large bb[i,j] = \sum^{i+br}<em>{y=i-br} \sum^{j+br}</em>{x=j-br} f[x,y] /(2 \cdot br)^2<br>$$</p>
<p>$$<br>\large  = \sum^{j+br}<em>{y=j-br}\left(\sum^{i+br}</em>{x=i-br} f[x,y]/(2 \cdot br)\right) / (2 \cdot br)<br>$$</p>
<p>这样我们将算法复杂度降到$O(n \cdot r)$</p>
<p>计算代码如下</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BoxBlur</span>(<span class="params">color[] src,color[] dst,<span class="keyword">int</span> r</span>)</span>&#123;</span><br><span class="line">    BlurHor(src,dst,r);</span><br><span class="line">    BlurVer(src,dst,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BlurHor</span>(<span class="params">color[] src,color[] dst, <span class="keyword">int</span> r</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;h;j++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;w;i++)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> val = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> ix = i-r;ix &lt;i+r;ix++)&#123;</span><br><span class="line">                val += src[j*w + ix];</span><br><span class="line">            &#125;</span><br><span class="line">            dst[j*w + i] = val /(r+r+<span class="number">1</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BlurVer</span>(<span class="params">color[] src,color[] dst, <span class="keyword">int</span> r</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;h;j++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;w;i++)&#123;</span><br><span class="line">            <span class="keyword">var</span> val = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> jy = j-r;jy &lt;j+r;jy++)&#123;</span><br><span class="line">                val += src[i + jy*w];</span><br><span class="line">            &#125;</span><br><span class="line">            dst[j*w + i] = val /(r+r+<span class="number">1</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="使用累加器减少采样"><a href="#使用累加器减少采样" class="headerlink" title="使用累加器减少采样"></a>使用累加器减少采样</h3><p>对于横向的的计算来说，相邻两个像素i,i+1。</p>
<p>$bb(i+1) = bb(i) - v(i-r) + v(i+1+r)$<br>所以我们可以使用一个累加器，对于每个像素的计算就不需要采样$2 \cdot r + 1$次像素了。<br>这样我们又可以将算法的复杂度从$O(n \cdot r)$ 降到$O(n)$。</p>
<p>到目前为止使用多次BoxBlur来逼近GaussianBlur包括优化就完成了。这篇Blog里有相应的BenchMark <a href="http://blog.ivank.net/fastest-gaussian-blur.html" target="_blank" rel="noopener">Fastest Gaussian Blur (in linear time)</a>。</p>
<h2 id="使用GPU计算模糊"><a href="#使用GPU计算模糊" class="headerlink" title="使用GPU计算模糊"></a>使用GPU计算模糊</h2><p>在很多GPU计算高斯模糊的算法中，将高斯分布的权重预计算存储到一张LookUpTexture中，这样减少shader中计算的指令数，我们这里不采用这种使用高斯分布权重直接计算的方式，而使用上文所描述的均值模糊来逼近。</p>
<p>虽然优化过后性能已经是原始算法的$1/200$，但对于游戏渲染来说几十ms的时间还是太久了。<br>考虑将BoxBlur迁移到GPU中进行计算时，对于上文提到的<a href="#使用累加器减少采样">使用累加器减少采样</a>这一步优化，也就是将复杂度降低到$O(n)$的步骤在Shader中是无法实现的。</p>
<p>由于GPU执行时高度并行化并且乱序的，累加器完全无法工作，这样我们就失去了最后一步的优化。</p>
<p>对于完全正确的高斯模糊算法来说。模糊的半径大小是严重影响算法的计算量的。半径越大，每个像素采样的次数越多。而在Shader执行中贴图采样也是性能开销最大的。</p>
<p>Shader模糊效果的一个需求是，shader的效率不应该随模糊半径而变化。不论是1个像素的模糊，还是100个像素半径的模糊，性能开销如果以$ (n^2) $增长是无法接受的。不过GPU有个好处是我们可以通过贴图的Downsample来通过一次采样获取到更多像素的颜色值。</p>
<h3 id="高斯模糊实现思路"><a href="#高斯模糊实现思路" class="headerlink" title="高斯模糊实现思路"></a>高斯模糊实现思路</h3><p>用一句话来概括就是，固定每个像素的采样次数，通过将原始图形按照模糊的半径进行缩放，以达成不同模糊半径有同样的运行效率。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> scale = <span class="number">2.0f</span> / boxsizeHalf;</span><br><span class="line">tempWith = Mathf.CeilToInt(src.width * scale);</span><br><span class="line">tempHeight = Mathf.CeilToInt(src.height * scale);</span><br></pre></td></tr></table></figure>
<p>其中<code>boxsizeHalf</code>是通过高斯模糊的radius计算出的，<code>tempWith</code>和<code>tempHeight</code>是原始图片被缩放后的大小。</p>
<p>这样我们在shader中进行采样时，每次采样的uv的跨度是一个texel,跨度太大就会产生artifact。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for(int x &#x3D; -4; x &lt;&#x3D; 4;x++)&#123;        &#x2F;&#x2F;每个像素采样4+1次</span><br><span class="line">    float u &#x3D; i.uv.x + x * _MainTex_TexelSize.x;</span><br><span class="line">    col +&#x3D; tex2D(_MainTex, float2(u,i.uv.y)).xyz;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>不同的模糊质量</strong></p>
<p>同时可以定义不同的模糊质量，分别每个像素采样（4、8、16）+1次。</p>
<p><strong>BoxBlur次数</strong></p>
<p>由于Peter Kovesi提出的高斯模糊逼近，可以进行任意次box blur。在具体实现的时候进行3次。也就是三次horizontal模糊和3次纵向模糊。同时在高斯模糊的半径与均值模糊box半径的计算中，多次box模糊的半径是不相同的。但是不同的半径我们需要多生成一张不同大小的rendertexture来计算，所以这里优化的时候取相同的半径，结果不会有太大差别。</p>
<p><img src="/images/fast-gaussian-blur.png" alt="blur radius 12px"></p>
<h3 id="另一种实现方式"><a href="#另一种实现方式" class="headerlink" title="另一种实现方式"></a>另一种实现方式</h3><p>由于上面的实现方式是根据通过缩放texture来实现的不同模糊半径的采样。这样在实现动态模糊的时候，也就是模糊半径动态变化时，会allocate大量的rendertexture。对显存的影响较大。但是如果模糊半径一直不变就不会产生这种影响。</p>
<p>还是一种实现方式就是根据blur质量固定降低texture的分辨率，1/2、1/4、1/8等。但是在采样时还是使用固定的采样次数。这种方式在blur半径较少模糊效果好，但是半径提升到每个采样跨越了多个texel，就会出现明显的artifact。如果要减少这种artifact就需要提升采样的次数。</p>
<p><img src="/images/fast-blur-artifact.png" alt="blur-artifact"></p>
<h2 id="Unity中实现代码"><a href="#Unity中实现代码" class="headerlink" title="Unity中实现代码"></a>Unity中实现代码</h2><p>SuperFastBlur.cs</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SuperFastBlur</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> Quality : <span class="keyword">int</span></span><br><span class="line">    &#123;</span><br><span class="line">        Low = <span class="number">2</span>,</span><br><span class="line">        Media = <span class="number">4</span>,</span><br><span class="line">        High = <span class="number">8</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> Material m_matBlur;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Range(0, 100)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> Radius = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> boxsizeHalf;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Quality BlurQuality = Quality.Media;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> tempWith;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> tempHeight;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">bool</span> ModeBlurScaling = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        m_matBlur = <span class="keyword">new</span> Material(Shader.Find(<span class="string">"Unlit/SuperFastBlurShader"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span>[] <span class="title">boxesForGauss</span>(<span class="params"><span class="keyword">float</span> sigma, <span class="keyword">int</span> n</span>)  <span class="comment">// standard deviation, number of boxes</span></span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> wIdeal = Mathf.Sqrt((<span class="number">12</span> * sigma * sigma / n) + <span class="number">1</span>);  <span class="comment">// Ideal averaging filter width </span></span><br><span class="line">        <span class="keyword">var</span> wl = Mathf.Floor(wIdeal); <span class="keyword">if</span> (wl % <span class="number">2</span> == <span class="number">0</span>) wl--;</span><br><span class="line">        <span class="keyword">var</span> wu = wl + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> mIdeal = (<span class="number">12</span> * sigma * sigma - n * wl * wl - <span class="number">4</span> * n * wl - <span class="number">3</span> * n) / (<span class="number">-4</span> * wl - <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">var</span> m = Mathf.RoundToInt(mIdeal);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> sizes = <span class="keyword">new</span> <span class="keyword">float</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            sizes[i] = (i &lt; m ? wl : wu);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sizes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnRenderImage</span>(<span class="params">RenderTexture src, RenderTexture dest</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Radius &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Graphics.Blit(src, dest);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        boxsizeHalf = boxesForGauss(Radius,<span class="number">3</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">float</span> boxsize = boxsizeHalf * <span class="number">2.0f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ModeBlurScaling)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">float</span> scale = (<span class="keyword">int</span>)BlurQuality * <span class="number">2.0f</span> / boxsizeHalf;</span><br><span class="line">            tempWith = Mathf.CeilToInt(src.width * scale);</span><br><span class="line">            tempHeight = Mathf.CeilToInt(src.height * scale);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            tempWith = Mathf.CeilToInt(src.width * (<span class="keyword">int</span>)BlurQuality / <span class="number">16</span>);</span><br><span class="line">            tempHeight = Mathf.CeilToInt(src.height * (<span class="keyword">int</span>)BlurQuality / <span class="number">16</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> temprtx1 = RenderTexture.GetTemporary(tempWith, tempHeight, <span class="number">0</span>, src.format, RenderTextureReadWrite.Default);</span><br><span class="line">        <span class="keyword">var</span> temprtx2 = RenderTexture.GetTemporary(tempWith, tempHeight, <span class="number">0</span>, src.format, RenderTextureReadWrite.Default);</span><br><span class="line"></span><br><span class="line">        m_matBlur.SetInt(<span class="string">"_quality"</span>, (<span class="keyword">int</span>)BlurQuality);</span><br><span class="line">        <span class="keyword">if</span> (!ModeBlurScaling)</span><br><span class="line">        &#123;</span><br><span class="line">            m_matBlur.DisableKeyword(<span class="string">"BlurScaling_ON"</span>);</span><br><span class="line">            m_matBlur.SetFloat(<span class="string">"_boxBlurRadius"</span>, boxsizeHalf);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            m_matBlur.EnableKeyword(<span class="string">"BlurScaling_ON"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Graphics.Blit(src, temprtx1, m_matBlur, <span class="number">1</span>);</span><br><span class="line">        Graphics.Blit(temprtx1, temprtx2, m_matBlur, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        Graphics.Blit(temprtx2, temprtx1, m_matBlur, <span class="number">0</span>);</span><br><span class="line">        Graphics.Blit(temprtx1, temprtx2, m_matBlur, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        Graphics.Blit(temprtx2, temprtx1, m_matBlur, <span class="number">0</span>);</span><br><span class="line">        Graphics.Blit(temprtx1, dest, m_matBlur, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        RenderTexture.ReleaseTemporary(temprtx1);</span><br><span class="line">        RenderTexture.ReleaseTemporary(temprtx2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SuperFastBlurShader.shader</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;Unlit&#x2F;SuperFastBlurShader&quot;</span><br><span class="line">&#123;</span><br><span class="line">	Properties</span><br><span class="line">	&#123;</span><br><span class="line">		_MainTex (&quot;Texture&quot;, 2D) &#x3D; &quot;white&quot; &#123;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	SubShader</span><br><span class="line">	&#123;</span><br><span class="line">		Cull Off ZWrite On ZTest Less</span><br><span class="line">		Pass</span><br><span class="line">		&#123;</span><br><span class="line">			Name &quot;BlurH&quot;</span><br><span class="line">			CGPROGRAM</span><br><span class="line">			#pragma vertex vert</span><br><span class="line">			#pragma fragment frag</span><br><span class="line">			#pragma multi_compile BlurScaling_OFF BlurScaling_ON</span><br><span class="line">			</span><br><span class="line">			#include &quot;UnityCG.cginc&quot;</span><br><span class="line"></span><br><span class="line">			struct appdata</span><br><span class="line">			&#123;</span><br><span class="line">				float4 vertex : POSITION;</span><br><span class="line">				float2 uv : TEXCOORD0;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			struct v2f</span><br><span class="line">			&#123;</span><br><span class="line">				float2 uv : TEXCOORD0;</span><br><span class="line">				float4 vertex : SV_POSITION;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			v2f vert (appdata v)</span><br><span class="line">			&#123;</span><br><span class="line">				v2f o;</span><br><span class="line">				o.vertex &#x3D; UnityObjectToClipPos(v.vertex);</span><br><span class="line">				o.uv &#x3D; v.uv;</span><br><span class="line">				return o;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			#if !BlurScaling_ON</span><br><span class="line">			float _boxBlurRadius &#x3D; 0;</span><br><span class="line">			#endif</span><br><span class="line">			</span><br><span class="line">			sampler2D _MainTex;</span><br><span class="line">			uniform float4 _MainTex_TexelSize;</span><br><span class="line"></span><br><span class="line">			int _quality &#x3D; 2; &#x2F;&#x2F;2 4 &#x2F;8</span><br><span class="line">			fixed4 frag (v2f i) : SV_Target</span><br><span class="line">			&#123;</span><br><span class="line">				float3 col  &#x3D;0;</span><br><span class="line"></span><br><span class="line">				#if BlurScaling_ON</span><br><span class="line">				float stepSize &#x3D; _MainTex_TexelSize.x;</span><br><span class="line">				#else</span><br><span class="line">				float stepSize &#x3D; _MainTex_TexelSize.x * _boxBlurRadius &#x2F; _quality &#x2F;4.0;</span><br><span class="line">				#endif</span><br><span class="line"></span><br><span class="line">				for(int x &#x3D; -_quality; x &lt;&#x3D; _quality;x++)&#123;</span><br><span class="line">					float u &#x3D; i.uv.x + x * stepSize;</span><br><span class="line">					col +&#x3D; tex2D(_MainTex, float2(u,i.uv.y)).xyz;</span><br><span class="line">				&#125;</span><br><span class="line">				col &#x3D; (col &#x2F; (_quality *2.0+ 1.0));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">				return float4(col,1);</span><br><span class="line">			&#125;</span><br><span class="line">			ENDCG</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Pass</span><br><span class="line">		&#123;</span><br><span class="line">			Name &quot;BlurV&quot;</span><br><span class="line">			CGPROGRAM</span><br><span class="line">			#pragma vertex vert</span><br><span class="line">			#pragma fragment frag</span><br><span class="line">			#pragma multi_compile BlurScaling_OFF BlurScaling_ON</span><br><span class="line">			</span><br><span class="line">			#include &quot;UnityCG.cginc&quot;</span><br><span class="line"></span><br><span class="line">			struct appdata</span><br><span class="line">			&#123;</span><br><span class="line">				float4 vertex : POSITION;</span><br><span class="line">				float2 uv : TEXCOORD0;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			struct v2f</span><br><span class="line">			&#123;</span><br><span class="line">				float2 uv : TEXCOORD0;</span><br><span class="line">				float4 vertex : SV_POSITION;</span><br><span class="line">			&#125;;</span><br><span class="line"></span><br><span class="line">			v2f vert (appdata v)</span><br><span class="line">			&#123;</span><br><span class="line">				v2f o;</span><br><span class="line">				o.vertex &#x3D; UnityObjectToClipPos(v.vertex);</span><br><span class="line">				o.uv &#x3D; v.uv;</span><br><span class="line">				return o;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			#if !BlurScaling_ON</span><br><span class="line">			float _boxBlurRadius &#x3D; 0;</span><br><span class="line">			#endif</span><br><span class="line">			</span><br><span class="line">			sampler2D _MainTex;</span><br><span class="line">			uniform float4 _MainTex_TexelSize;</span><br><span class="line"></span><br><span class="line">			int _quality &#x3D; 2; &#x2F;&#x2F;2 4 &#x2F;8</span><br><span class="line">			fixed4 frag (v2f i) : SV_Target</span><br><span class="line">			&#123;</span><br><span class="line">				float3 col&#x3D; 0;</span><br><span class="line"></span><br><span class="line">				#if BlurScaling_ON</span><br><span class="line">				float stepSize &#x3D; _MainTex_TexelSize.y;</span><br><span class="line">				#else</span><br><span class="line">				float stepSize &#x3D; _MainTex_TexelSize.y * _boxBlurRadius &#x2F; _quality &#x2F; 4.0;</span><br><span class="line">				#endif</span><br><span class="line"></span><br><span class="line">				for(int y &#x3D; -_quality; y &lt;&#x3D; _quality;y++)&#123;</span><br><span class="line">					float v &#x3D; i.uv.y + y * stepSize;</span><br><span class="line">					col +&#x3D; tex2D(_MainTex, float2(i.uv.x,v)).xyz;</span><br><span class="line">				&#125;</span><br><span class="line">				col &#x3D; (col &#x2F; (_quality *2+ 1));</span><br><span class="line">				return float4(col,1);</span><br><span class="line">			&#125;</span><br><span class="line">			ENDCG</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结</strong></p>
<p>GPU blur上的优化依旧是时间与空间的取舍，更多的显存消耗，固定的计算时间开销。固定的显存就可能需要更多的计算时间，所以优化还是需要看特定的情形来。有时间把Gaussian standard deviation与box radius的计算推导一下再来更新。</p>
<hr>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://blog.ivank.net/fastest-gaussian-blur.html" target="_blank" rel="noopener">Fastest Gaussian Blur (in linear time)</a></p>
<p><a href="http://www.peterkovesi.com/papers/FastGaussianSmoothing.pdf" target="_blank" rel="noopener">Fast Almost-Gaussian Filtering</a></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="https://artwork.yemi.me/" target="_blank" rel="noopener">Artworks</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#最快速的高斯模糊算法"><span class="toc-number">1.</span> <span class="toc-text">最快速的高斯模糊算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#高斯函数与模糊卷积"><span class="toc-number">1.1.</span> <span class="toc-text">高斯函数与模糊卷积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BoxBlur-均值模糊"><span class="toc-number">1.2.</span> <span class="toc-text">BoxBlur 均值模糊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Box-Blur优化"><span class="toc-number">1.3.</span> <span class="toc-text">Box Blur优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用累加器减少采样"><span class="toc-number">1.4.</span> <span class="toc-text">使用累加器减少采样</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用GPU计算模糊"><span class="toc-number">2.</span> <span class="toc-text">使用GPU计算模糊</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#高斯模糊实现思路"><span class="toc-number">2.1.</span> <span class="toc-text">高斯模糊实现思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#另一种实现方式"><span class="toc-number">2.2.</span> <span class="toc-text">另一种实现方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Unity中实现代码"><span class="toc-number">3.</span> <span class="toc-text">Unity中实现代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">4.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://yemi.me/2018/04/30/super-fast-blur-gpu/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&text=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&is_video=false&description=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=快速高斯模糊的Shader实现&body=Check out this article: https://yemi.me/2018/04/30/super-fast-blur-gpu/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&title=快速高斯模糊的Shader实现" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://yemi.me/2018/04/30/super-fast-blur-gpu/&name=快速高斯模糊的Shader实现&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 yemi
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="https://artwork.yemi.me/" target="_blank" rel="noopener">Artworks</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-117987782-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'yemiblog';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


